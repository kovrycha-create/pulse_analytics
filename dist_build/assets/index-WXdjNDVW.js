const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/StatusChip-V4sEFlgM.js","assets/vendor_react-Cb-iJF6D.js","assets/vendor-CdMoegv2.js","assets/vendor_recharts-DItNOE66.js"])))=>i.map(i=>d[i]);
import{j as e,r as m,R as A,b as z}from"./vendor_react-Cb-iJF6D.js";import{R as U,B as F,C as H,X as q,Y as G,T as Y,a as K,b as X}from"./vendor_recharts-DItNOE66.js";import"./vendor-CdMoegv2.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(n){if(n.ep)return;n.ep=!0;const c=t(n);fetch(n.href,c)}})();const W="modulepreload",J=function(o){return"/"+o},B={},Z=function(s,t,r){let n=Promise.resolve();if(t&&t.length>0){let x=function(d){return Promise.all(d.map(f=>Promise.resolve(f).then(N=>({status:"fulfilled",value:N}),N=>({status:"rejected",reason:N}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=a?.nonce||a?.getAttribute("nonce");n=x(t.map(d=>{if(d=J(d),d in B)return;B[d]=!0;const f=d.endsWith(".css"),N=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${N}`))return;const i=document.createElement("link");if(i.rel=f?"stylesheet":W,f||(i.as="script"),i.crossOrigin="",i.href=d,l&&i.setAttribute("nonce",l),document.head.appendChild(i),f)return new Promise((g,u)=>{i.addEventListener("load",g),i.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${d}`)))})}))}function c(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return n.then(a=>{for(const l of a||[])l.status==="rejected"&&c(l.reason);return s().catch(c)})},M=["#8884d8","#82ca9d","#ffc658","#ff8042","#0088FE","#00C49F"],T=({title:o,value:s,children:t})=>e.jsxs("div",{className:"bg-secondary p-6 rounded-lg border border-border",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:o}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:s}),t]}),Q=({data:o,totalViews:s,uniqueVisitors:t})=>{const r=o.slice(0,10);return e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Overview"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsx(T,{title:"Total Page Views",value:s}),e.jsx(T,{title:"Unique Visitors (by User Agent)",value:t}),e.jsx(T,{title:"Top Pages",value:o.length,children:e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Number of distinct pages tracked."})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-secondary p-6 rounded-lg border border-border",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Top 10 Pages by Views"}),e.jsx("div",{className:"h-80",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(F,{data:r,layout:"vertical",margin:{top:5,right:20,left:50,bottom:5},children:[e.jsx(H,{strokeDasharray:"3 3",stroke:"rgba(255, 255, 255, 0.1)"}),e.jsx(q,{type:"number",stroke:"#9ca3af"}),e.jsx(G,{type:"category",dataKey:"page",width:120,tick:{fill:"#9ca3af",fontSize:12},tickFormatter:n=>n.length>15?`${n.substring(0,15)}...`:n}),e.jsx(Y,{cursor:{fill:"rgba(255, 255, 255, 0.05)"},contentStyle:{backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"0.5rem"},labelStyle:{color:"#f9fafb"}}),e.jsx(K,{dataKey:"views",children:r.map((n,c)=>e.jsx(X,{fill:M[c%M.length]},`cell-${c}`))})]})})})]}),e.jsxs("div",{className:"bg-secondary p-6 rounded-lg border border-border",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"All Pages"}),e.jsx("div",{className:"overflow-y-auto max-h-80 pr-2",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx("th",{className:"p-2",children:"Page"}),e.jsx("th",{className:"p-2 text-right",children:"Views"})]})}),e.jsx("tbody",{children:o.map((n,c)=>e.jsxs("tr",{className:"border-b border-border/50",children:[e.jsx("td",{className:"p-2 truncate",title:n.page,children:n.page}),e.jsx("td",{className:"p-2 text-right font-mono",children:n.views})]},c))})]})})]})]})]})},ee=({views:o})=>{const s=o.slice(0,20),t=r=>{try{return new Date(r).toLocaleString()}catch{return r}};return e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Recent Hits"}),e.jsx("div",{className:"bg-secondary border border-border rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-sm",children:[e.jsx("thead",{className:"border-b border-border",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 font-medium",children:"Page"}),e.jsx("th",{scope:"col",className:"px-6 py-3 font-medium",children:"Referrer"}),e.jsx("th",{scope:"col",className:"px-6 py-3 font-medium",children:"Timestamp"}),e.jsx("th",{scope:"col",className:"px-6 py-3 font-medium",children:"User Agent"})]})}),e.jsx("tbody",{children:s.map(r=>e.jsxs("tr",{className:"border-b border-border/50 hover:bg-accent",children:[e.jsx("td",{className:"px-6 py-4 truncate max-w-xs",title:r.page,children:r.page}),e.jsx("td",{className:"px-6 py-4 text-muted-foreground truncate max-w-xs",title:r.referrer,children:r.referrer||"Direct"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-muted-foreground",children:t(r.timestamp)}),e.jsx("td",{className:"px-6 py-4 text-muted-foreground truncate max-w-sm",title:r.userAgent,children:r.userAgent})]},r.id))})]})})})]})},te={},R=m.createContext(void 0),se=()=>{const o=(typeof import.meta<"u"?te:{})||{},s=o&&o.VITE_API_BASE?String(o.VITE_API_BASE):"";if(s)return s.replace(/\/$/,"");try{const t=typeof window<"u"&&window.__VITE_API_BASE?String(window.__VITE_API_BASE):"";if(t)return t.replace(/\/$/,"")}catch{}return""},re=({children:o})=>{const s=se(),t="/api/health",r=`${t}?ping=1`,[n,c]=m.useState([]),[a,l]=m.useState("offline"),[x,d]=m.useState(null),[f,N]=m.useState(null),i=m.useRef(null),g=m.useRef(null),u=m.useRef(null),p=j=>{c(w=>[j,...w].slice(0,20))},b=m.useCallback(async(j=!1)=>{const w=s+(j?r:t),E={Accept:"application/json"},S=performance.now();let h={ts:new Date().toISOString(),ok:!1,statusCode:null,latencyMs:null};try{const y=await fetch(w,{method:"GET",headers:E}),C=Math.round(performance.now()-S);if(h.latencyMs=C,h.statusCode=y.status,(y.headers.get("content-type")||"").startsWith("application/json")){const k=await y.json();h.ok=!!k.ok&&y.status>=200&&y.status<300,d(k.version||null),k.db&&k.db}else{const k=await y.text();h.ok=!1,h.error="Non-JSON response",h.snippet=k.slice(0,120)}}catch(y){h.ok=!1,h.error=y?.message||String(y),h.latencyMs=h.latencyMs||null}if(p(h),h.ok){if(i.current=h,N(h.latencyMs||null),(h.latencyMs||0)>=1200)l("degraded");else try{const C=await(await fetch(w,{method:"GET",headers:E})).json();C.db&&C.db!=="ok"?l("degraded"):l("connected")}catch{l("connected")}u.current=null}else{const y=u.current||0;let C=y===0?3e4:Math.min(y*2,12e4);u.current=C;const P=i.current?Date.parse(i.current.ts):0,k=P?Date.now()-P:1/0;l((k>3e4,"offline"))}},[s]);m.useEffect(()=>{let j=!1;if(!s)return l("offline"),()=>{j=!0};const w=15e3,E=S=>{j||(g.current&&window.clearTimeout(g.current),g.current=window.setTimeout(async()=>{await b(!0);const h=u.current||0;if(h)E(h+Math.round(h*(Math.random()*.2-.1)));else{const y=Math.round(w*(Math.random()*.2-.1));E(w+y)}},S))};return(async()=>{await b(!1);const S=u.current||0;if(S)E(S);else{const h=Math.round(w*(Math.random()*.2-.1));E(w+h)}})(),()=>{j=!0,g.current&&window.clearTimeout(g.current)}},[b]);const I=m.useCallback(async()=>{await b(!1)},[b]),v=i.current;return e.jsx(R.Provider,{value:{state:a,lastSuccess:v,checks:n,version:x,latencyMs:f,baseUrl:s,retry:I},children:o})};function ne(){const o=m.useContext(R);if(!o)throw new Error("useHealth must be used within HealthProvider");return o}const ae=()=>{const[o,s]=m.useState(!1),r='<script async defer src="/tracker.js"><\/script>',n=()=>{navigator.clipboard.writeText(r).then(()=>{s(!0),setTimeout(()=>s(!1),2e3)})},c=()=>{try{const{state:a}=ne();return e.jsxs("div",{className:"inline-flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${a==="connected"?"bg-green-500":a==="degraded"?"bg-amber-500":"bg-red-600"}`}),e.jsxs("span",{className:"text-sm",children:["Tracker ",a==="connected"?"Connected ✓":"Disconnected ✕"]})]})}catch{return null}};return e.jsxs("div",{className:"bg-secondary border border-border rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Get Started"}),e.jsxs("p",{className:"text-muted-foreground mb-4",children:["To start tracking pageviews, add the following script tag to the ",e.jsx("code",{children:"<head>"})," section of your website's HTML."]}),e.jsx("div",{className:"mb-4",children:e.jsx(c,{})}),e.jsxs("div",{className:"bg-background border border-border rounded-md p-4 flex items-center justify-between",children:[e.jsx("pre",{className:"text-sm overflow-x-auto",children:e.jsx("code",{className:"text-primary",children:r})}),e.jsx("button",{onClick:n,className:"ml-4 px-3 py-1.5 text-sm font-medium bg-primary text-primary-foreground rounded-md hover:opacity-90 transition-opacity",children:o?"Copied!":"Copy"})]})]})},oe=({session:o,onClose:s})=>{if(!o)return null;const[t,r]=m.useState(null),n=m.useMemo(()=>{const a=o.views.map(d=>Date.parse(d.timestamp)),l=Math.min(...a),x=Math.max(...a);return{min:l,max:x}},[o]),c=(a,l)=>n.max===n.min?l/2:(a-n.min)/(n.max-n.min)*l;return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:s}),e.jsxs("div",{className:"relative bg-background rounded-lg shadow-lg w-11/12 md:w-3/4 lg:w-2/3 max-h-[80vh] overflow-y-auto p-6 border border-border",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold",children:["Session ",o.id]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o.pages.join(" → ")})]}),e.jsx("div",{children:e.jsx("button",{onClick:s,className:"px-3 py-1 rounded bg-secondary text-secondary-foreground",children:"Close"})})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-secondary p-3 rounded border border-border",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Start"}),e.jsx("div",{className:"font-mono",children:new Date(o.start).toLocaleString()})]}),e.jsxs("div",{className:"bg-secondary p-3 rounded border border-border",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Duration"}),e.jsxs("div",{className:"font-mono",children:[o.durationSeconds,"s"]})]})]}),e.jsx("h4",{className:"text-lg font-medium mb-2",children:"Events"}),e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"bg-secondary p-3 rounded border border-border",children:e.jsxs("div",{style:{position:"relative"},children:[e.jsxs("svg",{width:"100%",height:"60",viewBox:"0 0 800 60",preserveAspectRatio:"none",children:[e.jsx("line",{x1:"0",y1:"30",x2:"800",y2:"30",stroke:"#374151",strokeWidth:1}),o.views.map((a,l)=>{const x=Date.parse(a.timestamp),d=c(x,800);return e.jsx("circle",{cx:d,cy:30,r:6,fill:a.type==="page_unload"?"#f97316":a.type==="custom_event"?"#06b6d4":"#60a5fa",onMouseEnter:f=>r({x:f.clientX,y:f.clientY,text:`${new Date(x).toLocaleTimeString()} — ${a.type||"pageview"} ${a.page||""}`}),onMouseLeave:()=>r(null)},a.id||l)})]}),t&&e.jsx("div",{style:{position:"absolute",left:t.x-200,top:-40},className:"bg-background border border-border p-2 rounded text-sm shadow",children:t.text})]})})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx("th",{className:"p-2",children:"Time"}),e.jsx("th",{className:"p-2",children:"Type"}),e.jsx("th",{className:"p-2",children:"Page"}),e.jsx("th",{className:"p-2",children:"Time on page"}),e.jsx("th",{className:"p-2",children:"Scroll"}),e.jsx("th",{className:"p-2",children:"User Agent"})]})}),e.jsx("tbody",{children:o.views.map((a,l)=>e.jsxs("tr",{className:"border-b border-border/50",children:[e.jsx("td",{className:"p-2",children:new Date(a.timestamp).toLocaleString()}),e.jsx("td",{className:"p-2",children:a.type||"pageview"}),e.jsx("td",{className:"p-2 truncate max-w-xs",children:a.page}),e.jsx("td",{className:"p-2",children:a.timeOnPage!=null?`${a.timeOnPage}s`:"-"}),e.jsx("td",{className:"p-2",children:a.scrollDepth!=null?`${a.scrollDepth}%`:"-"}),e.jsx("td",{className:"p-2 truncate max-w-sm",title:a.userAgent,children:a.userAgent})]},a.id||l))})]})})]})]})},ce=({sessions:o})=>{const[s,t]=m.useState(null);return e.jsxs("div",{children:[e.jsxs("div",{className:"bg-secondary p-6 rounded-lg border border-border",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Sessions"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx("th",{className:"p-2",children:"Session ID"}),e.jsx("th",{className:"p-2",children:"Start"}),e.jsx("th",{className:"p-2",children:"Duration"}),e.jsx("th",{className:"p-2",children:"Pages"}),e.jsx("th",{className:"p-2",children:"Entry"}),e.jsx("th",{className:"p-2",children:"Exit"}),e.jsx("th",{className:"p-2",children:"Bounce"})]})}),e.jsx("tbody",{children:o.map(r=>e.jsxs("tr",{className:"border-b border-border/50 hover:bg-accent/5 cursor-pointer",onClick:()=>t(r),children:[e.jsx("td",{className:"p-2 font-mono truncate max-w-[12rem]",children:r.id}),e.jsx("td",{className:"p-2",children:new Date(r.start).toLocaleString()}),e.jsxs("td",{className:"p-2",children:[r.durationSeconds,"s"]}),e.jsx("td",{className:"p-2 truncate max-w-xs",title:r.pages.join(" → "),children:r.pages.join(" → ")}),e.jsx("td",{className:"p-2",children:r.entryPage}),e.jsx("td",{className:"p-2",children:r.exitPage}),e.jsx("td",{className:"p-2",children:r.isBounce?"Yes":"No"})]},r.id))})]})})]}),e.jsx(oe,{session:s,onClose:()=>t(null)})]})},_=({label:o,value:s,max:t})=>{const r=t===0?0:Math.round(s/t*100);return e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground mb-1",children:[e.jsx("span",{children:o}),e.jsx("span",{className:"font-mono",children:s})]}),e.jsx("div",{className:"bg-zinc-800 rounded h-6",children:e.jsx("div",{className:"bg-accent h-6 rounded",style:{width:`${r}%`}})})]})},le=({sessions:o,topN:s=5})=>{const t=m.useMemo(()=>{const r={},n={},c={};for(const i of o){i.entryPage&&(r[i.entryPage]=(r[i.entryPage]||0)+1),i.exitPage&&(c[i.exitPage]=(c[i.exitPage]||0)+1);for(const g of i.pages)n[g]=(n[g]||0)+1}const a=i=>Object.entries(i).sort((g,u)=>u[1]-g[1]).slice(0,s),l=a(r),x=a(n),d=a(c),f=Math.max(...l.map(([,i])=>i).concat(x.map(([,i])=>i)).concat(d.map(([,i])=>i)).length?[0]:[0]),N={entryTop:l,midTop:x,exitTop:d,max:f};return N.max=Math.max(l.length?l[0][1]:0,x.length?x[0][1]:0,d.length?d[0][1]:0),N},[o,s]);return e.jsxs("div",{className:"bg-secondary p-6 rounded-lg border border-border",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Session Funnel (Top Pages)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Entry Pages"}),t.entryTop.map(([r,n],c)=>e.jsx(_,{label:r,value:n,max:t.max},r+c))]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"All Pages (mid)"}),t.midTop.map(([r,n],c)=>e.jsx(_,{label:r,value:n,max:t.max},r+c))]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Exit Pages"}),t.exitTop.map(([r,n],c)=>e.jsx(_,{label:r,value:n,max:t.max},r+c))]})]})]})},$="pulse:theme";function L(){try{const o=localStorage.getItem($);return o||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"cybertech":"classic")}catch{return"classic"}}function O(o){if(o==="cybertech"){if(document.documentElement.setAttribute("data-theme","cybertech"),!document.getElementById("cybertech-css")){const s=document.createElement("link");s.id="cybertech-css",s.rel="stylesheet",s.href="/styles/theme.cybertech.css",s.onload=()=>{try{D(),console.info("[theme] cybertech CSS loaded")}catch{}},s.onerror=()=>{console.warn("[theme] failed to load cybertech CSS")},document.head.appendChild(s)}if(document.getElementById("cybertech-css"))try{D()}catch{}}else{document.documentElement.removeAttribute("data-theme");const s=document.getElementById("cybertech-css");s&&s.remove();const t=document.getElementById("cyber-bg-hex");t&&t.remove();const r=document.getElementById("cyber-sheen");r&&r.remove();const n=document.getElementById("cyber-glow");n&&n.remove();const c=document.getElementById("cyber-hex-mid");c&&c.remove();const a=document.getElementById("cyber-hex-fore");a&&a.remove();const l=document.getElementById("cyber-portal");l&&l.remove();const x=document.getElementById("cyber-portal-fallback");x&&x.remove();const d=document.getElementById("cybertech-inline-anims");d&&d.remove()}try{localStorage.setItem($,o)}catch{}}function D(){const o=()=>{let s=document.getElementById("cyber-portal");if(s||(s=document.createElement("div"),s.id="cyber-portal",s.setAttribute("aria-hidden","true"),s.style.position="fixed",s.style.inset="0",s.style.pointerEvents="none",s.style.zIndex="2147483647",s.style.transform="none",document.body.appendChild(s)),!document.getElementById("cyber-portal-fallback")){const t=document.createElement("style");t.id="cyber-portal-fallback",t.textContent="#cyber-portal, #cyber-portal > * { position: fixed !important; inset: 0 !important; pointer-events: none !important; z-index: 2147483647 !important; transform: none !important; } #cyber-portal .cyber-bg-hex { background-repeat: repeat !important; }",document.head.appendChild(t)}if(!document.getElementById("cyber-bg-hex")){const t=document.createElement("div");t.id="cyber-bg-hex",t.className="cyber-bg-hex",t.setAttribute("aria-hidden","true"),t.style.position="fixed",t.style.inset="0",t.style.backgroundImage="url('/img/hex-grid.svg')",t.style.backgroundRepeat="repeat",t.style.backgroundSize="160px 160px",t.style.backgroundPosition="0 0",t.style.pointerEvents="none",t.style.opacity="0.35",t.style.mixBlendMode="overlay",t.style.transform="translateZ(0)",t.style.zIndex="9998",t.style.willChange="transform, opacity, background-position",t.style.animation="hex-drift 36s linear infinite",(s||document.body).appendChild(t),console.info("[theme] created cyber-bg-hex")}if(!document.getElementById("cyber-hex-mid")){const t=document.createElement("div");t.id="cyber-hex-mid",t.className="cyber-hex-mid",t.setAttribute("aria-hidden","true"),t.style.position="fixed",t.style.inset="0",t.style.pointerEvents="none",t.style.backgroundImage="url('/img/hex-grid.svg')",t.style.backgroundRepeat="repeat",t.style.backgroundSize="240px 240px",t.style.backgroundPosition="0 0",t.style.opacity="0.25",t.style.mixBlendMode="overlay",t.style.zIndex="2147483646",t.style.animation="hex-parallax-slow 46s linear infinite",(s||document.body).appendChild(t),console.info("[theme] created cyber-hex-mid")}if(!document.getElementById("cyber-hex-fore")){const t=document.createElement("div");t.id="cyber-hex-fore",t.className="cyber-hex-fore",t.setAttribute("aria-hidden","true"),t.style.position="fixed",t.style.inset="0",t.style.pointerEvents="none",t.style.backgroundImage="url('/img/hex-grid.svg')",t.style.backgroundRepeat="repeat",t.style.backgroundSize="112px 112px",t.style.backgroundPosition="0 0",t.style.opacity="0.2",t.style.mixBlendMode="overlay",t.style.zIndex="2147483647",t.style.animation="hex-parallax-fast 28s linear infinite",(s||document.body).appendChild(t),console.info("[theme] created cyber-hex-fore")}if(!document.getElementById("cyber-sheen")){const t=document.createElement("div");t.id="cyber-sheen",t.className="cyber-sheen",t.setAttribute("aria-hidden","true"),t.style.position="fixed",t.style.inset="0",t.style.backgroundImage="linear-gradient(transparent 96%, rgba(255,255,255,.045) 100%)",t.style.backgroundSize="100% 32px",t.style.backgroundPosition="0 0",t.style.mixBlendMode="overlay",t.style.pointerEvents="none",t.style.zIndex="9999",t.style.opacity="0.95",t.style.animation="sheen-move 6s linear infinite",(s||document.body).appendChild(t),console.info("[theme] created cyber-sheen")}if(!document.getElementById("cyber-glow")){const t=document.createElement("div");t.id="cyber-glow",t.className="cyber-glow",t.setAttribute("aria-hidden","true"),t.style.position="fixed",t.style.inset="0",t.style.pointerEvents="none",t.style.zIndex="9997";const r=document.createElement("div"),n=document.createElement("div");r.style.position="absolute",r.style.left="-10%",r.style.top="-10%",r.style.width="50%",r.style.height="50%",r.style.filter="blur(40px)",r.style.opacity="0.28",r.style.mixBlendMode="screen",r.style.background="radial-gradient(circle at 20% 20%, rgba(0,173,181,0.55), transparent 40%)",n.style.position="absolute",n.style.right="-10%",n.style.bottom="-8%",n.style.width="50%",n.style.height="50%",n.style.filter="blur(40px)",n.style.opacity="0.28",n.style.mixBlendMode="screen",n.style.background="radial-gradient(circle at 80% 80%, rgba(138,92,246,0.28), transparent 35%)",r.style.animation="glow-pulse 6s ease-in-out infinite",n.style.animation="glow-pulse 8s ease-in-out infinite",t.appendChild(r),t.appendChild(n),(s||document.body).appendChild(t),console.info("[theme] created cyber-glow")}};if(!document.getElementById("cybertech-inline-anims")){const s=document.createElement("style");s.id="cybertech-inline-anims",s.textContent=`
@keyframes hex-drift { 0% { transform: translate3d(0,0,0) rotate(0deg); background-position: 0 0; } 50% { transform: translate3d(-12px,6px,0) rotate(180deg); background-position: -80px 40px; } 100% { transform: translate3d(0,0,0) rotate(360deg); background-position: 0 0; } }
@keyframes hex-parallax-slow { 0% { transform: translate3d(0,0,0); background-position: 0 0; } 50% { transform: translate3d(-8px,4px,0); background-position: -60px 30px; } 100% { transform: translate3d(0,0,0); background-position: 0 0; } }
@keyframes hex-parallax-fast { 0% { transform: translate3d(0,0,0); background-position: 0 0; } 50% { transform: translate3d(-24px,12px,0); background-position: -160px 80px; } 100% { transform: translate3d(0,0,0); background-position: 0 0; } }
@keyframes hex-rotate { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
@keyframes sheen-move { 0% { background-position: 0 0; } 100% { background-position: 0 48px; } }
@keyframes glow-pulse { 0% { opacity: .22; filter: blur(36px); } 50% { opacity: .42; filter: blur(20px); } 100% { opacity: .22; filter: blur(36px); } }
`,document.head.appendChild(s)}document.body?o():(window.addEventListener("DOMContentLoaded",()=>o(),{once:!0}),console.info("[theme] waiting for DOMContentLoaded to create overlays"))}function ie(){const o=L();O(o)}const de={},me=A.lazy(()=>Z(()=>import("./StatusChip-V4sEFlgM.js"),__vite__mapDeps([0,1,2,3]))),ue=()=>{const s=(()=>{const u=(typeof import.meta<"u"?de:{})||{},p=u&&u.VITE_API_BASE?String(u.VITE_API_BASE):"";if(p)return p.replace(/\/$/,"");try{const b=typeof window<"u"&&window.__VITE_API_BASE?String(window.__VITE_API_BASE):"";if(b)return b.replace(/\/$/,"")}catch{}return""})(),[t,r]=m.useState([]),[n,c]=m.useState(null),[a,l]=m.useState(!0),[x,d]=m.useState(null),[f,N]=m.useState(()=>L()),i=m.useCallback(async()=>{l(!0);try{const u=s?`${s}/api/stats`:"/api/stats",p=await fetch(u);if(!p.ok){let v="";try{v=(await p.text()).slice(0,200)}catch{}throw new Error(`Failed to fetch stats (${p.status}) ${v?`- ${v}`:""}`)}const b=p.headers.get("content-type")||"";if(!b.includes("application/json")){const v=await p.text();throw new Error(`Non-JSON response (${p.status}) ${b}: ${v.slice(0,200)}`)}const I=await p.json();I.sort((v,j)=>new Date(j.timestamp).getTime()-new Date(v.timestamp).getTime()),r(I);try{const v=s?`${s}/api/stats?aggregate=true`:"/api/stats?aggregate=true",j=await fetch(v);if(j.ok)if(!(j.headers.get("content-type")||"").includes("application/json"))c(null);else{const E=await j.json();c(E)}else c(null)}catch{c(null)}d(null)}catch(u){d(u instanceof Error?u.message:"An unknown error occurred"),r([])}finally{l(!1)}},[]);m.useEffect(()=>{i()},[i]),m.useEffect(()=>{try{O(f)}catch{}},[f]);const g=m.useMemo(()=>{const u=t.reduce((p,b)=>(p[b.page]=(p[b.page]||0)+1,p),{});return Object.entries(u).map(([p,b])=>({page:p,views:b})).sort((p,b)=>b.views-p.views)},[t]);return e.jsx("div",{className:"min-h-screen bg-background text-foreground p-4 sm:p-6 lg:p-8 cyber-content",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("header",{className:"mb-8 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight cyber-heading",children:"Pulse Analytics"}),e.jsx("p",{className:"text-muted-foreground",children:"A simple, self-hosted analytics dashboard."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(A.Suspense,{fallback:null,children:e.jsx(me,{})}),e.jsx("button",{onClick:i,disabled:a,className:"px-4 py-2 bg-secondary text-secondary-foreground rounded-md hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a?"Refreshing...":"Refresh"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:"Theme:"}),e.jsxs("select",{"aria-label":"Theme",value:f,onChange:u=>N(u.target.value),className:"px-3 py-2 rounded-md",children:[e.jsx("option",{value:"classic",children:"Classic"}),e.jsx("option",{value:"cybertech",children:"CyberTech"})]})]}),e.jsx("button",{onClick:i,disabled:a,className:"px-4 py-2 bg-secondary text-secondary-foreground rounded-md hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a?"Refreshing...":"Refresh"})]}),e.jsxs("main",{className:"space-y-8",children:[x&&e.jsxs("div",{className:"bg-red-900 border border-red-700 text-red-100 px-4 py-3 rounded-md",role:"alert",children:[e.jsx("strong",{className:"font-bold",children:"Error: "}),e.jsx("span",{className:"block sm:inline",children:x})]}),e.jsx(ae,{}),a?e.jsx("div",{className:"text-center py-10 text-muted-foreground",children:e.jsx("p",{children:"Loading analytics data..."})}):t.length===0&&!x?e.jsxs("div",{className:"text-center py-10 border-2 border-dashed border-border rounded-lg",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"No data yet!"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Embed the tracker script on your site to start seeing pageviews."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{data:g,totalViews:t.length,uniqueVisitors:new Set(t.map(u=>u.userAgent)).size}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx(le,{sessions:n&&n.sessions||[]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx(ce,{sessions:n&&n.sessions||[]})})]}),e.jsx(ee,{views:t})]})]})]})})};try{ie()}catch{}const V=document.getElementById("root");if(!V)throw new Error("Could not find root element to mount to");const he=z.createRoot(V);he.render(e.jsx(A.StrictMode,{children:e.jsx(re,{children:e.jsx(ue,{})})}));export{ne as u};
