import{r as d,j as e}from"./vendor_react-Cb-iJF6D.js";import{u as m}from"./index-xDDGBft9.js";import"./vendor-CdMoegv2.js";import"./vendor_recharts-DItNOE66.js";function h(t){if(!t)return"unknown";const n=Date.parse(t),r=Math.floor((Date.now()-n)/1e3);return r<60?`${r}s ago`:r<3600?`${Math.floor(r/60)}m ago`:`${Math.floor(r/3600)}h ago`}const u=({onClose:t,baseUrl:n})=>{const{checks:r,lastSuccess:c,retry:o,version:a}=m();d.useRef(null),d.useEffect(()=>{const s=i=>{i.key==="Escape"&&t()};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[t]);const l=async()=>{const s={checks:r,lastSuccess:c,version:a,baseUrl:n};try{await navigator.clipboard.writeText(JSON.stringify(s))}catch{}};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:t}),e.jsxs("div",{className:"relative bg-secondary border border-border rounded-lg p-4 w-full max-w-2xl z-10",role:"dialog","aria-modal":!0,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Backend Diagnostics"}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("button",{onClick:l,className:"px-2 py-1 bg-primary text-primary-foreground rounded",children:"Copy diagnostics"}),e.jsx("button",{onClick:()=>{o()},className:"px-2 py-1 bg-secondary-foreground border rounded",children:"Retry now"}),e.jsx("button",{onClick:t,className:"px-2 py-1",children:"Close"})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium",children:"Recent Checks"}),e.jsx("div",{className:"mt-2 overflow-auto max-h-64",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-muted-foreground",children:[e.jsx("th",{children:"Time"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Latency"}),e.jsx("th",{children:"Error"})]})}),e.jsx("tbody",{children:r.map((s,i)=>e.jsxs("tr",{className:"border-t border-border/50",children:[e.jsx("td",{className:"py-1",children:h(s.ts)}),e.jsx("td",{className:"py-1",children:s.ok?"ok":"fail"}),e.jsx("td",{className:"py-1",children:s.latencyMs?`${s.latencyMs}ms`:"-"}),e.jsx("td",{className:"py-1 truncate",children:s.error||s.snippet||"-"})]},i))})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium",children:"Configuration"}),e.jsxs("div",{className:"mt-2 text-sm font-mono bg-background border border-border p-2 rounded",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"BASE_URL:"})," ",n]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Health path:"})," /api/health"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"CORS origin:"})," ",location.origin]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Version:"})," ",a||"unknown"]})]})]})]})]})]})},x={connected:{color:"bg-green-500",label:"Connected"},degraded:{color:"bg-amber-500",label:"Degraded"},offline:{color:"bg-red-600",label:"Offline"}},b=()=>{const{state:t,latencyMs:n,version:r,baseUrl:c}=m(),[o,a]=d.useState(!1),l=x[t]||x.offline,s=t==="connected"?"status-online":t==="degraded"?"status-degraded":"status-offline";return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>a(!0),className:`status-chip ${s} focus:outline-none focus:ring-2 focus:ring-offset-2 text-sm`,"aria-haspopup":"dialog","aria-expanded":o,"aria-label":`Backend status: ${l.label}`,role:"status",children:[e.jsx("span",{className:"dot","aria-hidden":!0,style:{backgroundColor:"currentColor"}}),e.jsx("span",{className:"sr-only",children:"Status:"}),e.jsx("span",{"aria-live":"polite",children:l.label}),e.jsx("span",{className:"ml-2 font-mono text-xs opacity-90",children:n?`${n}ms`:""})]}),o&&e.jsx(u,{onClose:()=>a(!1),baseUrl:c})]})};export{b as default};
//# sourceMappingURL=StatusChip-oqenBLHJ.js.map
